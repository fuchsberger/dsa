defmodule Dsa.Data.Advantage do
  @moduledoc """
  CharacterAdvantage module
  """
  use Ecto.Schema
  import Ecto.Changeset

  require Logger

  @table :advantages

  schema "advantages" do
    field :advantage_id, :integer
    field :details, :string
    belongs_to :character, Dsa.Characters.Character
  end

  def changeset(advantage, params \\ %{}) do
    advantage
    |> cast(params, [:advantage_id, :character_id, :details])
    |> validate_required([:advantage_id, :character_id])
    |> validate_number(:advantage_id, greater_than: 0, less_than_or_equal_to: count())
    |> validate_length(:details, max: 50)
    |> foreign_key_constraint(:character_id)
  end

  def count, do: :ets.info(@table, :size)
  def list, do: :ets.tab2list(@table)

  def options, do: Enum.map(list(), fn {id, name, ap, _details} -> {"#{name} (#{ap})", id} end)

  def name(id), do: :ets.lookup_element(@table, id, 2)
  def ap(id), do: :ets.lookup_element(@table, id, 3)
  def details(id), do: :ets.lookup_element(@table, id, 4)

  def seed do
    entries = [
      # {ID, Name, AP, Details}
      {1, "Adel I", 5, false},
      {2, "Adel II", 10, false},
      {3, "Adel III", 15, false},
      {4, "Altersresistenz", 5, false},
      {5, "Angenehmer Geruch", 6, false},
      {6, "Begabung: Alchimie", 18, false},
      {7, "Begabung: Bekehren & Überzeugen", 12, false},
      {8, "Begabung: Betören", 12, false},
      {9, "Begabung: Boote & Schiffe", 12, false},
      {10, "Begabung: Brett & Glücksspiel", 6, false},
      {11, "Begabung: Einschüchtern", 12, false},
      {12, "Begabung: Etikette", 12, false},
      {13, "Begabung: Fährtensuchen", 18, false},
      {14, "Begabung: Fahrzeuge", 6, false},
      {15, "Begabung: Fesseln", 6, false},
      {16, "Begabung: Fischen & Angeln", 6, false},
      {17, "Begabung: Fliegen", 12, false},
      {18, "Begabung: Gassenwissen", 18, false},
      {19, "Begabung: Gaukeleien", 6, false},
      {20, "Begabung: Geographie", 12, false},
      {21, "Begabung: Geschichtswissen", 12, false},
      {22, "Begabung: Götter & Kulte", 12, false},
      {23, "Begabung: Handel", 12, false},
      {24, "Begabung: Heilkunde Gift", 12, false},
      {25, "Begabung: Heilkunde Krankheiten", 12, false},
      {26, "Begabung: Heilkunde Seele", 12, false},
      {27, "Begabung: Heilkunde Wunden", 24, false},
      {28, "Begabung: Holzbearbeitung", 12, false},
      {29, "Begabung: Klettern", 12, false},
      {30, "Begabung: Körperbeherrschung", 24, false},
      {31, "Begabung: Kraftakt", 12, false},
      {32, "Begabung: Kriegskunst", 12, false},
      {33, "Begabung: Lebensmittelbearbeitung", 6, false},
      {34, "Begabung: Lederbearbeitung", 12, false},
      {35, "Begabung: Magiekunde", 18, false},
      {36, "Begabung: Malen & Zeichnen", 6, false},
      {37, "Begabung: Mechanik", 12, false},
      {38, "Begabung: Menschenkenntnis", 18, false},
      {39, "Begabung: Metallbearbeitung", 18, false},
      {40, "Begabung: Musizieren", 6, false},
      {41, "Begabung: Orientierung", 12, false},
      {42, "Begabung: Pflanzenkunde", 18, false},
      {43, "Begabung: Rechnen", 6, false},
      {44, "Begabung: Rechtskunde", 6, false},
      {45, "Begabung: Reiten", 12, false},
      {46, "Begabung: Sagen & Legenden", 12, false},
      {47, "Begabung: Schlösserknacken", 18, false},
      {48, "Begabung: Schwimmen", 12, false},
      {49, "Begabung: Selbstbeherrschung", 24, false},
      {50, "Begabung: Singen", 6, false},
      {51, "Begabung: Sinnesschärfe", 24, false},
      {52, "Begabung: Spärenkunde", 12, false},
      {53, "Begabung: Steinbearbeitung", 6, false},
      {54, "Begabung: Sternkunde", 6, false},
      {55, "Begabung: Stoffbearbeitung", 6, false},
      {56, "Begabung: Tanzen", 6, false},
      {57, "Begabung: Taschendiebstahl", 12, false},
      {58, "Begabung: Tierkunde", 18, false},
      {59, "Begabung: Überreden", 18, false},
      {60, "Begabung: Verbergen", 18, false},
      {61, "Begabung: Verkleiden", 12, false},
      {62, "Begabung: Wildnisleben", 18, false},
      {63, "Begabung: Willenskraft", 24, false},
      {64, "Begabung: Zechen", 6, false},
      {65, "Beidhändig", 15, false},
      {66, "Dunkelsicht I", 10, false},
      {67, "Dunkelsicht II", 20, false},
      {68, "Eisenaffine Aura", 15, false},
      {69, "Entfernungssinn", 10, false},
      {70, "Flink", 8, false},
      {71, "Fuchssinn", 15, false},
      {72, "Geborener Redner", 4, false},
      {73, "Geweihter", 25, false},
      {74, "Giftresistenz I", 10, false},
      {75, "Giftresistenz II", 20, false},
      {76, "Glück I", 30, false},
      {77, "Glück II", 60, false},
      {78, "Glück III", 90, false},
      {79, "Gutaussehend I", 20, false},
      {80, "Gutaussehend II", 40, false},
      {81, "Herausragende Fertigkeit: Alchimie", 6, false},
      {82, "Herausragende Fertigkeit: Bekehren & Überzeugen", 4, false},
      {83, "Herausragende Fertigkeit: Betören", 4, false},
      {84, "Herausragende Fertigkeit: Boote & Schiffe", 4, false},
      {85, "Herausragende Fertigkeit: Brett & Glücksspiel", 2, false},
      {86, "Herausragende Fertigkeit: Einschüchtern", 4, false},
      {87, "Herausragende Fertigkeit: Etikette", 4, false},
      {88, "Herausragende Fertigkeit: Fährtensuchen", 6, false},
      {89, "Herausragende Fertigkeit: Fahrzeuge", 2, false},
      {90, "Herausragende Fertigkeit: Fesseln", 2, false},
      {91, "Herausragende Fertigkeit: Fischen & Angeln", 2, false},
      {92, "Herausragende Fertigkeit: Fliegen", 4, false},
      {93, "Herausragende Fertigkeit: Gassenwissen", 6, false},
      {94, "Herausragende Fertigkeit: Gaukeleien", 2, false},
      {95, "Herausragende Fertigkeit: Geographie", 4, false},
      {96, "Herausragende Fertigkeit: Geschichtswissen", 4, false},
      {97, "Herausragende Fertigkeit: Götter & Kulte", 4, false},
      {98, "Herausragende Fertigkeit: Handel", 4, false},
      {99, "Herausragende Fertigkeit: Heilkunde Gift", 4, false},
      {100, "Herausragende Fertigkeit: Heilkunde Krankheiten", 4, false},
      {101, "Herausragende Fertigkeit: Heilkunde Seele", 4, false},
      {102, "Herausragende Fertigkeit: Heilkunde Wunden", 8, false},
      {103, "Herausragende Fertigkeit: Holzbearbeitung", 4, false},
      {104, "Herausragende Fertigkeit: Klettern", 4, false},
      {105, "Herausragende Fertigkeit: Körperbeherrschung", 8, false},
      {106, "Herausragende Fertigkeit: Kraftakt", 4, false},
      {107, "Herausragende Fertigkeit: Kriegskunst", 4, false},
      {108, "Herausragende Fertigkeit: Lebensmittelbearbeitung", 2, false},
      {109, "Herausragende Fertigkeit: Lederbearbeitung", 4, false},
      {110, "Herausragende Fertigkeit: Magiekunde", 6, false},
      {111, "Herausragende Fertigkeit: Malen & Zeichnen", 2, false},
      {112, "Herausragende Fertigkeit: Mechanik", 4, false},
      {113, "Herausragende Fertigkeit: Menschenkenntnis", 6, false},
      {114, "Herausragende Fertigkeit: Metallbearbeitung", 6, false},
      {115, "Herausragende Fertigkeit: Musizieren", 2, false},
      {116, "Herausragende Fertigkeit: Orientierung", 4, false},
      {117, "Herausragende Fertigkeit: Pflanzenkunde", 6, false},
      {118, "Herausragende Fertigkeit: Rechnen", 2, false},
      {119, "Herausragende Fertigkeit: Rechtskunde", 2, false},
      {120, "Herausragende Fertigkeit: Reiten", 4, false},
      {121, "Herausragende Fertigkeit: Sagen & Legenden", 4, false},
      {122, "Herausragende Fertigkeit: Schlösserknacken", 6, false},
      {123, "Herausragende Fertigkeit: Schwimmen", 4, false},
      {124, "Herausragende Fertigkeit: Selbstbeherrschung", 8, false},
      {125, "Herausragende Fertigkeit: Singen", 2, false},
      {126, "Herausragende Fertigkeit: Sinnesschärfe", 8, false},
      {127, "Herausragende Fertigkeit: Spärenkunde", 4, false},
      {128, "Herausragende Fertigkeit: Steinbearbeitung", 2, false},
      {129, "Herausragende Fertigkeit: Sternkunde", 2, false},
      {130, "Herausragende Fertigkeit: Stoffbearbeitung", 2, false},
      {131, "Herausragende Fertigkeit: Tanzen", 2, false},
      {132, "Herausragende Fertigkeit: Taschendiebstahl", 4, false},
      {133, "Herausragende Fertigkeit: Tierkunde", 6, false},
      {134, "Herausragende Fertigkeit: Überreden", 6, false},
      {135, "Herausragende Fertigkeit: Verbergen", 6, false},
      {136, "Herausragende Fertigkeit: Verkleiden", 4, false},
      {137, "Herausragende Fertigkeit: Wildnisleben", 6, false},
      {138, "Herausragende Fertigkeit: Willenskraft", 8, false},
      {139, "Herausragende Fertigkeit: Zechen", 2, false},
      {140, "Herausragende Kampftechnik: Armbrüste", 12, false},
      {141, "Herausragende Kampftechnik: Blasrohre", 12, false},
      {142, "Herausragende Kampftechnik: Bögen", 16, false},
      {143, "Herausragende Kampftechnik: Diskusse", 16, false},
      {144, "Herausragende Kampftechnik: Dolche", 12, false},
      {145, "Herausragende Kampftechnik: Fächer", 16, false},
      {146, "Herausragende Kampftechnik: Fechtwaffen", 16, false},
      {147, "Herausragende Kampftechnik: Feuerspeien", 12, false},
      {148, "Herausragende Kampftechnik: Hiebwaffen", 16, false},
      {149, "Herausragende Kampftechnik: Kettenwaffen", 16, false},
      {150, "Herausragende Kampftechnik: Lanzen", 12, false},
      {151, "Herausragende Kampftechnik: Peitschen", 12, false},
      {152, "Herausragende Kampftechnik: Raufen", 12, false},
      {153, "Herausragende Kampftechnik: Schilde", 16, false},
      {154, "Herausragende Kampftechnik: Schleudern", 12, false},
      {155, "Herausragende Kampftechnik: Schwerter", 16, false},
      {156, "Herausragende Kampftechnik: Spießwaffen", 16, false},
      {157, "Herausragende Kampftechnik: Stangenwaffen", 16, false},
      {158, "Herausragende Kampftechnik: Wurfwaffen", 12, false},
      {159, "Herausragende Kampftechnik: Zweihandhiebwaffen", 16, false},
      {160, "Herausragende Kampftechnik: Zweihandschwerter", 16, false},
      {161, "Herausragender Sinn: Gehör", 12, false},
      {162, "Herausragender Sinn: Geruch & Geschmack", 6, false},
      {163, "Herausragender Sinn: Sicht", 12, false},
      {164, "Herausragender Sinn: Tastsinn", 2, false},
      {165, "Hitzeresistenz", 5, false},
      {166, "Hohe Astralkraft I", 6, false},
      {167, "Hohe Astralkraft II", 12, false},
      {168, "Hohe Astralkraft III", 18, false},
      {169, "Hohe Astralkraft IV", 24, false},
      {170, "Hohe Astralkraft V", 30, false},
      {171, "Hohe Astralkraft VI", 36, false},
      {172, "Hohe Astralkraft VII", 42, false},
      {173, "Hohe Karmalkraft I", 6, false},
      {174, "Hohe Karmalkraft II", 12, false},
      {175, "Hohe Karmalkraft III", 18, false},
      {176, "Hohe Karmalkraft IV", 24, false},
      {177, "Hohe Karmalkraft V", 30, false},
      {178, "Hohe Karmalkraft VI", 36, false},
      {179, "Hohe Karmalkraft VII", 42, false},
      {180, "Hohe Lebenskraft I", 6, false},
      {181, "Hohe Lebenskraft II", 12, false},
      {182, "Hohe Lebenskraft III", 18, false},
      {183, "Hohe Lebenskraft IV", 24, false},
      {184, "Hohe Lebenskraft V", 30, false},
      {185, "Hohe Lebenskraft VI", 36, false},
      {186, "Hohe Lebenskraft VII", 42, false},
      {187, "Hohe Seelenkraft", 25, false},
      {188, "Hohe Zähigkeit", 25, false},
      {189, "Immunität gegen (Gift)", 1, true},
      {190, "Immunität gegen (Gift)", 2, true},
      {191, "Immunität gegen (Gift)", 3, true},
      {192, "Immunität gegen (Krankheit)", 1, true},
      {193, "Immunität gegen (Krankheit)", 2, true},
      {194, "Immunität gegen (Krankheit)", 3, true},
      {195, "Kälteresistenz", 5, false},
      {196, "Krankheitsresistenz I", 10, false},
      {197, "Krankheitsresistenz II", 10, false},
      {198, "Magische Einstimmung", 40, false},
      {199, "Mystiker", 20, false},
      {200, "Nichtschläfer", 8, false},
      {201, "Pragmatiker", 10, false},
      {202, "Reich I", 1, false},
      {203, "Reich II", 2, false},
      {204, "Reich III", 3, false},
      {205, "Reich IV", 4, false},
      {206, "Reich V", 5, false},
      {207, "Reich VI", 6, false},
      {208, "Reich VII", 7, false},
      {209, "Reich VIII", 8, false},
      {210, "Reich IX", 9, false},
      {211, "Reich X", 10, false},
      {212, "Richtungssinn", 10, false},
      {213, "Schlangenmensch", 6, false},
      {214, "Schwer zu verzaubern", 15, false},
      {215, "Soziale Anpassungsfähigkeit", 10, false},
      {216, "Unscheinbar", 4, false},
      {217, "Verbesserte Regeneration (Astralenergie) I", 10, false},
      {218, "Verbesserte Regeneration (Astralenergie) II", 20, false},
      {219, "Verbesserte Regeneration (Astralenergie) III", 30, false},
      {220, "Verbesserte Regeneration (Karmaenergie) I", 10, false},
      {221, "Verbesserte Regeneration (Karmaenergie) II", 20, false},
      {222, "Verbesserte Regeneration (Karmaenergie) III", 30, false},
      {223, "Verbesserte Regeneration (Lebensenergie) I", 10, false},
      {224, "Verbesserte Regeneration (Lebensenergie) II", 20, false},
      {225, "Verbesserte Regeneration (Lebensenergie) III", 30, false},
      {226, "Verhüllte Aura", 20, false},
      {227, "Vertrauenerweckend", 25, false},
      {228, "Waffenbegabung: Armbrüste", 10, false},
      {229, "Waffenbegabung: Blasrohre", 10, false},
      {230, "Waffenbegabung: Bögen", 15, false},
      {231, "Waffenbegabung: Diskusse", 15, false},
      {232, "Waffenbegabung: Dolche", 10, false},
      {233, "Waffenbegabung: Fächer", 15, false},
      {234, "Waffenbegabung: Fechtwaffen", 15, false},
      {235, "Waffenbegabung: Feuerspeien", 10, false},
      {236, "Waffenbegabung: Hiebwaffen", 15, false},
      {237, "Waffenbegabung: Kettenwaffen", 15, false},
      {238, "Waffenbegabung: Lanzen", 10, false},
      {239, "Waffenbegabung: Peitschen", 10, false},
      {240, "Waffenbegabung: Raufen", 10, false},
      {241, "Waffenbegabung: Schilde", 15, false},
      {242, "Waffenbegabung: Schleudern", 10, false},
      {243, "Waffenbegabung: Schwerter", 15, false},
      {244, "Waffenbegabung: Spießwaffen", 15, false},
      {245, "Waffenbegabung: Stangenwaffen", 15, false},
      {246, "Waffenbegabung: Wurfwaffen", 10, false},
      {247, "Waffenbegabung: Zweihandhiebwaffen", 15, false},
      {248, "Waffenbegabung: Zweihandschwerter", 15, false},
      {249, "Wohlklang", 5, false},
      {250, "Zäher Hund", 20, false},
      {251, "Zauberer", 25, false},
      {252, "Zeitgefühl", 2, false},
      {253, "Zweistimmiger Gesang", 5, false},
      {254, "Zwergennase", 8, false},
    ]

    :ets.new(@table , [:ordered_set, :protected, :named_table])
    :ets.insert(@table, entries)
  end
end
